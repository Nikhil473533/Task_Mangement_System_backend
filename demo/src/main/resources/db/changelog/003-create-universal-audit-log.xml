<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
               xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
               xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
               xsi:schemaLocation="
                http://www.liquibase.org/xml/ns/dbchangelog
                https://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.27.xsd">
   <changeSet id="003-create-universal-audit-log" author="njoglekar">
   
   <createTable tableName="audit_log">
     <column name="id" type="BIGINT" autoIncrement="true">
       <constraints primaryKey="true"/>
     </column>
     
     <column name="entity_name" type="VARCHAR(100)">
       <constraints nullable="false"/>
     </column>
     
     <column name="entity_id" type="BIGINT">
       <constraints nullable="false"/>
     </column>
     
     <column name="action" type="VARCHAR(30)">
        <constraints nullable="false"/>
     </column>
     
     <column name="before_state" type="NVARCHAR(MAX)"/>
     <column name="after_state" type="NVARCHAR(MAX)"/>
     
     <column name="event_time" type="DATETIME2">
       <constraints nullable="false"/>
     </column>
   </createTable>
   <createIndex indexName="idx_audit_entity" tableName="audit_log">
    <column name="entity_name"/>
    <column name="entity_id"/>
   </createIndex>
 </changeSet>
</databaseChangeLog>  